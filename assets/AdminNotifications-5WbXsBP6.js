import{c as S,r as l,n,j as e,A,y,z as b,D as C,U as E}from"./index-C9ak4Gh3.js";import{C as p}from"./chart-column-B8dFD8ks.js";const L=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],T=S("shield-alert",L),R=()=>{const[r,j]=l.useState(null),[c,o]=l.useState("ACTIVE"),[k,f]=l.useState(!0),[t,d]=l.useState({title:"",message:"",segment:"ALL",dietPreference:"",activityLink:""}),[x,h]=l.useState(!1),[i,m]=l.useState(null);l.useEffect(()=>{g(),N()},[]);const N=async()=>{try{const s=await n.getStats();o(s.data.systemStatus||"ACTIVE")}catch(s){console.error("Failed to fetch system status:",s)}},g=async()=>{try{const s=await n.getStats();j(s.data),o(s.data.systemStatus||"ACTIVE")}catch(s){console.error("Failed to fetch stats:",s)}finally{f(!1)}},v=async s=>{s.preventDefault(),h(!0),m(null);try{const a=await n.sendBroadcast(t);m({type:"success",message:`Broadcast sent successfully! Target: ${a.data.results.sent} users.`}),d({title:"",message:"",segment:"ALL",dietPreference:"",activityLink:""}),g()}catch{m({type:"error",message:"Failed to send broadcast."})}finally{h(!1)}},w=async()=>{const s=c==="ACTIVE"?"PAUSED":"ACTIVE";if(window.confirm(`${s==="PAUSED"?"HALT":"RESUME"} ALL NOTIFICATIONS?`))try{const a=await n.toggleSystemStatus(s);o(s),alert(a.data.message)}catch(a){console.error(a),alert("Action failed.")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Notification Command Center"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage broadcasts, segments, and system-wide alerts"})]}),e.jsxs("button",{onClick:w,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all shadow-sm border ${c==="ACTIVE"?"bg-red-50 text-red-600 border-red-100 hover:bg-red-100":"bg-emerald-50 text-emerald-600 border-emerald-100 hover:bg-emerald-100"}`,children:[e.jsx(T,{className:"w-5 h-5"}),c==="ACTIVE"?"EMERGENCY STOP":"RESUME SYSTEM"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Total Sent"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r?.total||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center",children:e.jsx(y,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Read Rate"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r?.readRate||"0%"})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-50 text-amber-600 rounded-xl flex items-center justify-center",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 font-medium",children:"Active Campaigns"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r?.typeStats?.length||0})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50/50 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-gray-800",children:"Compose Broadcast"})]}),e.jsxs("form",{onSubmit:v,className:"p-6 space-y-4",children:[i&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center gap-3 ${i.type==="success"?"bg-emerald-50 text-emerald-700":"bg-red-50 text-red-700"}`,children:[i.type==="success"?e.jsx(y,{className:"w-5 h-5"}):e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:i.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Segment"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["ALL","DIET","INACTIVE"].map(s=>e.jsx("button",{type:"button",onClick:()=>d({...t,segment:s}),className:`py-2 text-xs font-bold rounded-lg border transition-all ${t.segment===s?"bg-primary text-white border-primary shadow-sm":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:s},s))})]}),t.segment==="DIET"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cuisine Preference"}),e.jsxs("select",{className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-primary",value:t.dietPreference,onChange:s=>d({...t,dietPreference:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Cuisine..."}),e.jsx("option",{value:"Italian",children:"Italian"}),e.jsx("option",{value:"Asian",children:"Asian"}),e.jsx("option",{value:"Mexican",children:"Mexican"}),e.jsx("option",{value:"Vegan",children:"Vegan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{required:!0,type:"text",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-primary",placeholder:"e.g., Happy Lunar New Year! ðŸ‰",value:t.title,onChange:s=>d({...t,title:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message Body"}),e.jsx("textarea",{required:!0,rows:"4",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-primary text-sm",placeholder:"What would you like to say to your users?",value:t.message,onChange:s=>d({...t,message:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Link (Optional)"}),e.jsx("input",{type:"text",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:border-primary",placeholder:"/recipes or /inventory",value:t.activityLink,onChange:s=>d({...t,activityLink:s.target.value})})]}),e.jsx("button",{disabled:x,type:"submit",className:"w-full py-3 bg-primary text-white rounded-xl font-bold hover:bg-emerald-600 transition-all shadow-lg flex items-center justify-center gap-2 disabled:opacity-50",children:x?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5"}),"SEND BROADCAST"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50/50 flex items-center gap-2",children:[e.jsx(p,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-gray-800",children:"Notification Volume by Type"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[Array.isArray(r?.typeStats)&&r.typeStats.map((s,a)=>{const u=(s._count._all/r.total*100).toFixed(0);return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider",children:[e.jsx("span",{className:"text-gray-500",children:s.type}),e.jsxs("span",{className:"text-gray-900",children:[s._count._all," (",u,"%)"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${s.type==="EXPIRY"?"bg-red-500":s.type==="GROCERY"?"bg-blue-500":s.type==="MEAL"?"bg-emerald-500":"bg-purple-500"}`,style:{width:`${u}%`}})})]},a)}),!r?.typeStats?.length&&e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-gray-400 text-sm",children:"No data available yet"})})]}),e.jsx("div",{className:"mt-8 p-4 bg-primary/5 rounded-xl border border-primary/10",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-800",children:"Audience Reach"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Based on current segments, a broadcast to "ALL" will reach approximately 100% of your active user base.'})]})]})})]})]})]})]})};export{R as default};
