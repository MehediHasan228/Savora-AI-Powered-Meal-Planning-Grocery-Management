import{c as j,r as l,k as i,j as e,l as u,i as p,T as n,h as c}from"./index-OuQwanVl.js";import{C as b}from"./chart-column-DwmDX4K3.js";import{A as f}from"./arrow-right-B4WeU8wM.js";const y=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],x=j("list-checks",y),k=()=>{const[t,o]=l.useState(null),[r,m]=l.useState(null),[h,g]=l.useState(!0);l.useEffect(()=>{d()},[]);const d=async()=>{try{const[s,a]=await Promise.all([i.getInsights(),i.getWaste()]);o(s.data),m(a.data)}catch(s){console.error("Failed to fetch analytics:",s)}finally{g(!1)}};return h?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("p",{className:"mt-4 text-gray-500 font-medium",children:"Analyzing behavioral data..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Behavioral Analytics"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Insights into purchasing habits, postponement, and waste detection"})]}),e.jsx("button",{onClick:d,className:"p-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",title:"Refresh Data",children:e.jsx(u,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 bg-blue-50 text-blue-600 rounded-xl",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Total Purchases"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:t?.totalPurchases||0})]})]}),e.jsx("div",{className:"w-full bg-gray-100 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-blue-500 h-full w-2/3"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 bg-emerald-50 text-emerald-600 rounded-xl",children:e.jsx(x,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Avg. List Size"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:t?.avgListSize||0})]})]}),e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"+2.3% from last week"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 bg-amber-50 text-amber-600 rounded-xl",children:e.jsx(n,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Postponement"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:t?.postponedItems||0})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'Items marked as "Buy Later"'})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-xl",children:e.jsx(c,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Overbuy Rate"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:t?.overbuyTendency||"0%"})]})]}),e.jsx("p",{className:"text-xs text-red-500 font-medium",children:"Potential for excess stock"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between",children:e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-primary"}),"Most Purchased Staples"]})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:t?.mostPurchased?.length>0?t.mostPurchased.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-xs font-bold text-gray-500",children:["#",a+1]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:s.name}),e.jsxs("span",{className:"text-xs font-bold text-primary",children:[s._count.name,"x"]})]}),e.jsx("div",{className:"w-full bg-gray-50 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-primary/60 h-full rounded-full transition-all duration-300",style:{width:`${s._count.name/t.mostPurchased[0]._count.name*100}%`}})})]})]},a)):e.jsx("p",{className:"text-center py-10 text-gray-400 text-sm italic",children:"No purchase history found."})})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(c,{className:"w-5 h-5 text-red-500"}),"High-Waste Items"]}),e.jsx("span",{className:"text-xs font-bold text-red-600 bg-red-50 px-2 py-1 rounded-full uppercase tracking-wider",children:"Warning"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-6",children:r?.highWasteItems?.length>0?r.highWasteItems.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-50/30 rounded-xl border border-red-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white shadow-sm flex items-center justify-center",children:e.jsx(n,{className:"w-5 h-5 text-red-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Expired ",s.count," times in last month"]})]})]}),e.jsxs("button",{className:"text-xs font-bold text-primary flex items-center gap-1 hover:underline",children:["Adjust Threshold ",e.jsx(f,{className:"w-3 h-3"})]})]},a)):e.jsxs("div",{className:"text-center py-10",children:[e.jsx("div",{className:"w-16 h-16 bg-green-50 text-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(x,{className:"w-8 h-8"})}),e.jsx("h4",{className:"text-sm font-bold text-gray-800",children:"Excellent Work!"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"No significant food waste patterns detected."})]})}),r?.totalExpired>0&&e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl border border-gray-100",children:e.jsxs("p",{className:"text-xs text-gray-600 leading-relaxed italic",children:['"Tip: You tend to overbuy ',e.jsx("strong",{children:r.highWasteItems?.[0]?.name||"staples"}),'. We recommend reducing the default quantity in your Shopping List."']})})]})]})]})]})};export{k as default};
